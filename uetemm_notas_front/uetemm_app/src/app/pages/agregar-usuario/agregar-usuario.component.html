<h1 mat-dialog-title>Agregar Nuevo Usuario</h1>
<div mat-dialog-content class="mt-3 pt-2">
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
        <div class="container">
            <div class="row mt-3 mt-3">
                <div class="col-md-12">
                    <mat-form-field appearance="outline" style="width: 100%;">
                        <mat-label>Nombres</mat-label>
                        <input matInput formControlName="firstname" required>
                        @if (nombres.invalid) {
                        <mat-error> {{errorMessage}}</mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12">
                    <mat-form-field appearance="outline" style="width: 100%;">
                        <mat-label>Apellidos</mat-label>
                        <input matInput formControlName="lastname" required>
                        @if (apellidos.invalid) {
                        <mat-error> {{errorMessage}}</mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12">
                    <mat-form-field appearance="outline" style="width: 100%;">
                        <mat-label>Cédula / Nombre de Usuario</mat-label>
                        <input matInput formControlName="username" required (focusout)="verificarUserName($event)">
                        @if (cedula.invalid) {
                        <mat-error> {{errorMessage}}</mat-error>
                        }
                    </mat-form-field>
                    @if(existeUsername){
                    <mat-error>El usuario ya se encuentra registrado.</mat-error>
                    }

                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12">
                    <mat-form-field appearance="outline" style="width: 100%;">
                        <mat-label>Email Personal</mat-label>
                        <input matInput formControlName="email" email>
                        @if (email.hasError('email')) {
                        <mat-error> Debe ser un e-mail válido ejemplo
                            'example&#64;email.com'.</mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12" style="margin-left: auto; margin-right: 0;">
                    <mat-form-field appearance="outline" style="width: 100%;">
                        <mat-label>Rol</mat-label>
                        <mat-select [value]="1" formControlName="rol">
                            @for (rol of roles; track rol) {
                            <mat-option [value]="rol.value">{{rol.viewValue}}</mat-option>
                            }
                        </mat-select>

                        @if (email.hasError('rol')) {
                        <mat-error> {{errorMessage}}</mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
        </div>

        <div mat-dialog-actions>
            <button mat-button type="button" (click)="onCancel()">Cancelar</button>
            <button mat-flat-button type="submit" disabled="{{existeUsername}}" [color]="color">Agregar</button>
        </div>
    </form>

</div>